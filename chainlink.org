#+FILETAGS: :chainlink:

* Oracles                                                           :oracles:

Oracles allow deterministic blockchains interact with real-world data.

** Types

- Inbound Oracles :: Deliver external data to blockchains
- Outbound Oracles :: Deliver data from the blockchain to external
  systems
- Consensus Oracles :: Aggregate data from multiple sources and
  provide a single source of truth for smart contracts
- Cross-chain Oracles :: Enable communication and data exchange
  between multiple blockchain systems.

** Centralized vs Decentralized Oracles

- Centralized Oracles :: Operate through a single entity/node. Risks
  include single point of failure, data manipulation
- Decentralized Oracles :: Multiple independent nodes to fetch and
  validate data. Enhances security, reliability and transparency
  creating a trust-minimized system.

* Chainlink                                :decentralized_oracle_network:DON:

Chainlink is a decentralized oracle network that provides smart
contracts off-chain and cross-chain data in a decentralized, reliable
and secure manner.

** Problems addressed

*** The Trust Problem
How can the blockchain trust data from the outside world?

- Multiple operators forming a DON fetch data from different sources
  and compare their findings, reaching consensus of the correct answer

*** The Accuracy Problem
How can we ensure the data is accurate?

- Chainlink carefully selects nodes, verifies their reputation, and
  use cryptographic proofs to verify who produces what information

*** The Reliability Problem
What happens when a data source goes down?

- By using multiple independent nodes and data sources, when some of
  them go down others will keep functioning.

** Services                                                       :ccip:CCIP:

- Data Feeds :: Allow smart contracts to access external data
  e.g. price feeds
- Data Streams :: Provide access to high-frequency low-latency data
  and verifiable on-chain
- Automation ::  Allows smart contracts to react to real-world events
- Cross Chain Interoperability Protocol (CCIP) :: Allows
  inter-blockchain communication in a secure and distributed manner
- Chainlink Functions :: Provide the ability to perform custom
  computation off-chain
- Verifiable Random Function :: Acts as a fair and verifiable
  random-number generator that cannot be manipulated or predicted

** LINK Token                                                     :link:LINK:

Serves two functions:

- Payment to node operators for their services
- Incentivizes good node operator behaviour since they stake their
  LINK tokens to participate

* Data Feeds                                                     :data_feeds:

Components:

- Consumer :: on-chain or off-chain contract that uses the Chainlink
  service.
- Proxy Contract :: Points to the correct aggregator contract, acting
  as an intermediary that allows underlying contract be upgraded
  without service disruption
- Aggregator Contract :: Managed by chainlink and receives data
  updates from the decentralized oracle network
  
* Automation                                                     :automation:

Automation is a decentralized service that allows smart contract code
be executed based on some predefined offchain conditions or frequency.

** Upkeep                                                            :upkeep:

An upkeep is a registered job that the network will watch on-chain
to trigger actions when appropriate.

** Automation triggers

Conditions that trigger automation:

- Time-based :: execute based on a cron expression
- Custom Logic :: Defined in the contract. The contract implements a
  =checkUpkeep= that returns a boolean indicating conditions are right
  for execution.
- Log trigger :: Monitors blockchain events, and execute some custom
  contract code based on these events

** Automation Architecture                                     :architecture:

- Coordinated by an =automation registry= smart contract onchain
- Developers register upkeeps
- Node operators register automation nodes
- Automation nodes vote on which upkeeps to perform, sign and send to
  Automation registry
- Registry validates the reports, execute the upkeep functions and reward node operators.

* Cross-Chain Interoperability Protocol (CCIP)                         :ccip:

** Token bridging                                                  :bridging:

4 mechanisms:

- Lock and Mint :: Tokens are locked in a secure smart contract in the
  source chain, and wrapped representations are minted in the
  destination chain. In the reverse direction, the wrapped tokens are
  burned and the locked tokens are released.
- Burn and Mint :: Tokens are burned in the source chain and new ones
  are minted in the destination chain, and the same in
  reverse. Suitable for native tokens with mint authority.
- Lock and Unlock :: Tokens are locked in the source chain and
  released from a liquidity pool in the destination chain. Same in
  reverse. Requires incentivized liquidity providers on both sides
- Burn and Unlock :: Tokens burned in the source chain and released
  from a liquidity reserve in the destination chain.

** Security considerations                                         :security:

Tradeoffs are made between 3 critical properties:

- Security :: Resistance to attacks and manipulation
- Trust assumptions :: The degree of trust placed on oracles and
  operators. Chainlink tries to minimize this
- Configuration flexibility :: Adaptability to different blockchain
  architectures

*** Security Features

- Multiple independent nodes
- 3 separate DONs with to separate responsibilities:
  - Committing in source chain
  - Execution in dest chain
  - Risk management
- Client diversity (different languages) to reduce centralization

** Capabilities

- Arbitrary messaging between blockchains
- Token transfers
- Programmable token transfers (Combine token transfers and execution
  instruction e.g. staking,lending..)


** Architecture                                                :architecture:

- Router :: User facing contracts deployed on each blockchain managing
  approvals and transfers
- Sender :: An EOA or Smart contract account initiating transactions
- Receiver :: An EOA or smart contract account that receives
  transactions
- Transactional DONs :: Execute and commit cross-chain transactions
- Risk Managment DONs :: Reviews the batches committed transactions to
  verify integrity and security

** High-Level CCIP Flow Lifecycle                                 :lifecycle:

- Sender calls the Router on the source chain.
- Router routes the request to the appropriate OnRamp.
- Committing DON observes and commits the message.
- RMN independently validates the message.
- Executing DON executes the message on the destination chain.
- Receiver contract (or EOA) receives tokens and/or data via
  =ccipReceive=.

** Finality                                                        :finality:

Finality determines the point at which a transaction is permanent and
irreversible. Different blockchains have different mechanisms of
determining finality. CCIP makes this considerations when determining
finality in the source chain before proceeding with cross-chain
transactions.

** Cross-Chain Token (CCT) Standard                                     :CCT:

Enables developers to make new and existing ERC-20 tokens transferable
via CCIP without manual involvement of chainlink

*** Motivations

- Avoid liquidity fragmentation across chains limiting accessibility
- Enabling developer autonomy by eliminating the need for third-party
  approvals by making deployment self-service.

*** Benefits

- Self-service and permissionless
- Enhanced security through Chainlink's defence in depth
- Supports programmable transfer (token transfer + custom
  instructions)
- Chainlink provides audited =TokenPool= contracts that simplify
  deployment:
  - Replaces the need for traditional liquidity pools for burn/mint
    mechanisms
  - For lock/unlock approaches, a liquidity pool is still needed in
    the dest chain
- Zero slippage on cross chain transfers - exact amount delivered

*** How it works

**** Components

- Token Owner/CCIP Admin :: Entity that manages the token contract
  (upgrades, ownership changes)
- Token Administrator :: An entity (can be owner/admin) that manages
  cross-chain operation and maps token to =TokenPool= in
  =TokenAdminRegistry=
- TokenPool :: Contracts that manage locking/burning/unlocking/minting
  of tokens across chains

**** Implementation Steps

- Deploy the token in the every chain to support and with function to get owner/admin
- Deploy =TokenPool= contracts in each chain (audited or custom)
- Configure =TokenPool= contracts e.g. rate limits
- Register token admin and link token to =TokenPool= via =TokenAdminRegistry=

*** Supported Mechanisms

- burn/mint
- lock/unlock
- burn/unlock
- lock/mint

* Chainlink Functions                                   :chainlink_functions:

Provides off-chain trust-minimized compute infrastructure for custom
computation.

** Benefits

- Enables access to traditional public facing API's
- Enables custom computation that would be too expensive on-chain
- DONs provide distributed computation minimizing single points of
  failures
- Results are aggregated using the =Offchain Reporting (OCR) Protocol=
  giving trust-minimzed and consensus driven results
- Threshold encryption is used to encrypt secrets so that they can
  only be decrypted through multi-party decryption process.

** How it works

- Request initiation :: the smart contract sends JS code in a request
- Distributed execution :: Each node independently executes it in a
  secure serverless environment
- Result Aggregation :: The DON aggregates all the independent
  execution results
- Response Delivery :: The final consensus result is returned to the
  contract

* VRF: Verifiable Random Function            :vrf:verifiable_random_function:

Provides a cryptographically secure source of randomness for smart
contracts.

** How it works

- VRF generates one or more random values
- Creates a cryptographic proof demonstrating how the values were
  determined
- Publishes proof on-chain
- Verifies the proof before they are used by smart contracts

** How to access the Service

- Subscription Method :: A subscription is created and funded, which
  multiple contracts can connect to. Best for applications requiring
  frequent randomness
- Direct Funding Method :: Each contract directly pays for its
  randomness requests. Best for applications requiring infrequent
  randomness.

* Data Streams                                                 :data_streams:

Provides pull-based sub-second access to near real time data to smart
contracts.

Primarily provides market pricing data for assets.

** Components

- Data Stream DONs :: The nodes in the DON collect data from many
  sources and agree on the median value of an item. They then sign
  this value and deliver it to the aggregation network
- Aggregation Network :: The aggregation data collects data and makes
  it available to consumers. Uses an "active-active multi-site
  deployment" architecture to make it highly available
- Verifier contract :: Verifies the signature from the DON
  cryptographically guaranteeing that it wasn't modified by the time
  it is consumed by on-chain applications

* Chainlink Proof of Reserve (PoR)                 :proof_of_reserve:PoR:por:

Provides automated, real-time verification of reserves backing
tokenized assets.

** Use Cases

- Stablecoin issuers proving that each token is fully backed by
  reserves in real time
- Wrapped assets proving that each asset is backed 1:1 with the
  underlying asset
- Tokenized commodities e.g. tokenized gold can be proven to be backed
  with real commodities held in vaults
- DEFI protocols utilize PoR to automate actions that maintain system
  health e.g. adjusting risk parameters

** How it works

- Monitor reserve addresses to verify balance in reserve accounts
- Verify off-chain reserves by connecting to APIs and other data
  sources used in tradfi
- Process reserve data in the DON by aggregating and validating it
  through consensus
- Create cryptographic proofs verifying the generated reports
- Deliver verifiable reports on-chain for use by smart conntracts
- Enable automated actions based on the reports e.g. control minting
  based on collateralization ratios
